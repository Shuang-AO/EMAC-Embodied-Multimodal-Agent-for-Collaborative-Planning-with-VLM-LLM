[W socket.cpp:436] [c10d] The server socket cannot be initialized on [::]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/transformers/utils/hub.py:105: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
| distributed init (rank 0, world 1): env://
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
2025-04-08 22:19:28,098 [INFO] 
=====  Running Parameters    =====
2025-04-08 22:19:28,099 [INFO] {
    "accum_grad_iters": 8,
    "amp": true,
    "batch_size_eval": 1,
    "batch_size_train": 4,
    "device": "cuda",
    "dist_backend": "nccl",
    "dist_url": "env://",
    "distributed": true,
    "evaluate": true,
    "gpu": 0,
    "init_lr": 1e-05,
    "lr_sched": "linear_warmup_cosine_lr",
    "max_epoch": 10,
    "max_len": 128,
    "min_len": 5,
    "min_lr": 0,
    "num_beams": 1,
    "num_workers": 4,
    "output_dir": "/srv/scratch/CRUISE/shuang/output/EMAC/no_text_cond_proj_tuning",
    "rank": 0,
    "resume_ckpt_path": null,
    "seed": 42,
    "task": "captioning",
    "test_splits": [],
    "train_splits": [
        "train"
    ],
    "valid_splits": [
        "val"
    ],
    "warmup_lr": 1e-08,
    "warmup_steps": 1000,
    "weight_decay": 0.05,
    "world_size": 1
}
2025-04-08 22:19:28,099 [INFO] 
======  Dataset Attributes  ======
2025-04-08 22:19:28,099 [INFO] 
======== alfworld_cap =======
2025-04-08 22:19:28,099 [INFO] {
    "build_info": {
        "annotations": {
            "train": {
                "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json",
                "url": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json"
            },
            "val": {
                "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json",
                "url": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json"
            }
        },
        "images": {
            "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/images/alfworld_train"
        }
    },
    "data_type": "images",
    "text_processor": {
        "eval": {
            "max_words": 1024,
            "name": "blip_alfworld",
            "prompt": ""
        },
        "train": {
            "max_words": 1024,
            "name": "blip_alfworld",
            "prompt": ""
        }
    },
    "vis_processor": {
        "eval": {
            "image_size": 224,
            "name": "blip_image_eval"
        },
        "train": {
            "image_size": 224,
            "name": "blip_image_eval"
        }
    }
}
2025-04-08 22:19:28,099 [INFO] 
======  Model Attributes  ======
2025-04-08 22:19:28,099 [INFO] {
    "adaptor_tuning": false,
    "apply_lemmatizer": false,
    "arch": "blip2_emac",
    "avg_log_probs": true,
    "base_model": "https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth",
    "drop_path_rate": 0,
    "freeze_proj_layer": false,
    "freeze_qformer": true,
    "freeze_vit": true,
    "image_size": 224,
    "llm_model": "/srv/scratch/CRUISE/shuang/huggingface/hub/vicuna-7b-v1.1",
    "load_basemodel": true,
    "load_finetuned": false,
    "load_pretrained": false,
    "low_memory": true,
    "max_output_txt_len": 64,
    "max_txt_len": 1024,
    "mix_ratio": 0.5,
    "model_type": "vicuna13b",
    "num_query_token": 32,
    "pretrained": "https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth",
    "qformer_text_input": false,
    "use_grad_checkpoint": true,
    "vit_precision": "fp16"
}
2025-04-08 22:19:28,101 [INFO] Using existing file /srv/scratch/CRUISE/shuang/dataset/emac/train.json.
2025-04-08 22:19:28,101 [INFO] Using existing file /srv/scratch/CRUISE/shuang/dataset/emac/train.json.
2025-04-08 22:19:28,102 [INFO] Building datasets...
Path of dataset: /srv/scratch/CRUISE/shuang/dataset/emac/train.json
Size of dataset: 178585
Path of dataset: /srv/scratch/CRUISE/shuang/dataset/emac/train.json
Size of dataset: 178585
2025-04-08 22:19:40,020 [INFO] freeze vision encoder
2025-04-08 22:19:42,439 [INFO] freeze Qformer
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `pad_token_id` should be positive but got -1. This will cause errors when batch generating, if there is padding. Please set `pad_token_id` explicitly as `model.generation_config.pad_token_id=PAD_TOKEN_ID` to avoid errors in generation
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.59s/it]
2025-04-08 22:20:06,429 [INFO] load base model from https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth
2025-04-08 22:20:06,479 [INFO] Evaluating on val.
2025-04-08 22:20:06,479 [INFO] dataset_ratios not specified, datasets will be concatenated (map-style datasets) or chained (webdataset.DataPipeline).
2025-04-08 22:20:06,479 [INFO] Loaded 178585 records for train split from the dataset.
2025-04-08 22:20:06,479 [INFO] Loaded 178585 records for val split from the dataset.
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Traceback (most recent call last):
  File "/srv/scratch/CRUISE/shuang/code/emac/train.py", line 96, in <module>
    main()
  File "/srv/scratch/CRUISE/shuang/code/emac/train.py", line 92, in main
    runner.train()
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/runners/runner_base.py", line 378, in train
    val_log = self.eval_epoch(
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/runners/runner_base.py", line 467, in eval_epoch
    results = self.task.evaluation(model, data_loader)
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/tasks/base_task.py", line 97, in evaluation
    eval_output = self.valid_step(model=model, samples=samples)
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/tasks/captioning.py", line 59, in valid_step
    img_ids = samples["image_id"]
KeyError: 'image_id'
[2025-04-08 22:20:29,032] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 929738) of binary: /srv/scratch/CRUISE/shuang/miniconda3/envs/emac/bin/python
Traceback (most recent call last):
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 810, in <module>
    main()
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 806, in main
    run(args)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-04-08_22:20:29
  host      : wp-zeta-b21.cse.unsw.edu.au
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 929738)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[W socket.cpp:436] [c10d] The server socket cannot be initialized on [::]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/transformers/utils/hub.py:105: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
| distributed init (rank 0, world 1): env://
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
2025-04-10 14:43:05,840 [INFO] 
=====  Running Parameters    =====
2025-04-10 14:43:05,840 [INFO] {
    "accum_grad_iters": 8,
    "amp": true,
    "batch_size_eval": 1,
    "batch_size_train": 4,
    "device": "cuda",
    "dist_backend": "nccl",
    "dist_url": "env://",
    "distributed": true,
    "evaluate": true,
    "gpu": 0,
    "init_lr": 1e-05,
    "lr_sched": "linear_warmup_cosine_lr",
    "max_epoch": 10,
    "max_len": 128,
    "min_len": 5,
    "min_lr": 0,
    "num_beams": 1,
    "num_workers": 4,
    "output_dir": "/srv/scratch/CRUISE/shuang/output/EMAC/no_text_cond_proj_tuning",
    "rank": 0,
    "resume_ckpt_path": null,
    "seed": 42,
    "task": "captioning",
    "test_splits": [],
    "train_splits": [
        "train"
    ],
    "valid_splits": [
        "val"
    ],
    "warmup_lr": 1e-08,
    "warmup_steps": 1000,
    "weight_decay": 0.05,
    "world_size": 1
}
2025-04-10 14:43:05,840 [INFO] 
======  Dataset Attributes  ======
2025-04-10 14:43:05,841 [INFO] 
======== alfworld_cap =======
2025-04-10 14:43:05,841 [INFO] {
    "build_info": {
        "annotations": {
            "train": {
                "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json",
                "url": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json"
            },
            "val": {
                "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/eval.json",
                "url": "/srv/scratch/CRUISE/shuang/dataset/emac/eval.json"
            }
        },
        "images": {
            "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/images/alfworld_train"
        }
    },
    "data_type": "images",
    "text_processor": {
        "eval": {
            "max_words": 1024,
            "name": "blip_alfworld",
            "prompt": ""
        },
        "train": {
            "max_words": 1024,
            "name": "blip_alfworld",
            "prompt": ""
        }
    },
    "vis_processor": {
        "eval": {
            "image_size": 224,
            "name": "blip_image_eval"
        },
        "train": {
            "image_size": 224,
            "name": "blip_image_eval"
        }
    }
}
2025-04-10 14:43:05,841 [INFO] 
======  Model Attributes  ======
2025-04-10 14:43:05,841 [INFO] {
    "adaptor_tuning": false,
    "apply_lemmatizer": false,
    "arch": "blip2_emac",
    "avg_log_probs": true,
    "base_model": "https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth",
    "drop_path_rate": 0,
    "freeze_proj_layer": false,
    "freeze_qformer": true,
    "freeze_vit": true,
    "image_size": 224,
    "llm_model": "/srv/scratch/CRUISE/shuang/huggingface/hub/vicuna-7b-v1.1",
    "load_basemodel": true,
    "load_finetuned": false,
    "load_pretrained": false,
    "low_memory": true,
    "max_output_txt_len": 64,
    "max_txt_len": 1024,
    "mix_ratio": 0.5,
    "model_type": "vicuna13b",
    "num_query_token": 32,
    "pretrained": "https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth",
    "qformer_text_input": false,
    "use_grad_checkpoint": true,
    "vit_precision": "fp16"
}
2025-04-10 14:43:05,853 [INFO] Using existing file /srv/scratch/CRUISE/shuang/dataset/emac/train.json.
2025-04-10 14:43:05,853 [INFO] Using existing file /srv/scratch/CRUISE/shuang/dataset/emac/eval.json.
2025-04-10 14:43:05,856 [INFO] Building datasets...
Path of dataset: /srv/scratch/CRUISE/shuang/dataset/emac/train.json
Size of dataset: 178585
Path of dataset: /srv/scratch/CRUISE/shuang/dataset/emac/eval.json
Size of dataset: 178585
2025-04-10 14:43:18,185 [INFO] freeze vision encoder
2025-04-10 14:43:20,831 [INFO] freeze Qformer
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `pad_token_id` should be positive but got -1. This will cause errors when batch generating, if there is padding. Please set `pad_token_id` explicitly as `model.generation_config.pad_token_id=PAD_TOKEN_ID` to avoid errors in generation
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.70s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.64s/it]
2025-04-10 14:43:44,894 [INFO] load base model from https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth
2025-04-10 14:43:44,928 [INFO] Evaluating on val.
2025-04-10 14:43:44,928 [INFO] dataset_ratios not specified, datasets will be concatenated (map-style datasets) or chained (webdataset.DataPipeline).
2025-04-10 14:43:44,928 [INFO] Loaded 178585 records for train split from the dataset.
2025-04-10 14:43:44,928 [INFO] Loaded 178585 records for val split from the dataset.
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Traceback (most recent call last):
  File "/srv/scratch/CRUISE/shuang/code/emac/train.py", line 96, in <module>
    main()
  File "/srv/scratch/CRUISE/shuang/code/emac/train.py", line 92, in main
    runner.train()
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/runners/runner_base.py", line 378, in train
    val_log = self.eval_epoch(
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/runners/runner_base.py", line 467, in eval_epoch
    results = self.task.evaluation(model, data_loader)
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/tasks/base_task.py", line 97, in evaluation
    eval_output = self.valid_step(model=model, samples=samples)
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/tasks/captioning.py", line 59, in valid_step
    img_ids = samples["image_id"]
KeyError: 'image_id'
[2025-04-10 14:44:09,787] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 2654972) of binary: /srv/scratch/CRUISE/shuang/miniconda3/envs/emac/bin/python
Traceback (most recent call last):
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 810, in <module>
    main()
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 806, in main
    run(args)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-04-10_14:44:09
  host      : wp-zeta-c20.cse.unsw.edu.au
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2654972)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[W socket.cpp:436] [c10d] The server socket cannot be initialized on [::]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/transformers/utils/hub.py:105: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
| distributed init (rank 0, world 1): env://
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
2025-04-14 03:00:18,311 [INFO] 
=====  Running Parameters    =====
2025-04-14 03:00:18,312 [INFO] {
    "accum_grad_iters": 8,
    "amp": true,
    "batch_size_eval": 1,
    "batch_size_train": 4,
    "device": "cuda",
    "dist_backend": "nccl",
    "dist_url": "env://",
    "distributed": true,
    "evaluate": true,
    "gpu": 0,
    "init_lr": 1e-05,
    "lr_sched": "linear_warmup_cosine_lr",
    "max_epoch": 10,
    "max_len": 128,
    "min_len": 5,
    "min_lr": 0,
    "num_beams": 1,
    "num_workers": 4,
    "output_dir": "/srv/scratch/CRUISE/shuang/output/EMAC/no_text_cond_proj_tuning",
    "rank": 0,
    "resume_ckpt_path": null,
    "seed": 42,
    "task": "captioning",
    "test_splits": [],
    "train_splits": [
        "train"
    ],
    "valid_splits": [],
    "warmup_lr": 1e-08,
    "warmup_steps": 1000,
    "weight_decay": 0.05,
    "world_size": 1
}
2025-04-14 03:00:18,312 [INFO] 
======  Dataset Attributes  ======
2025-04-14 03:00:18,312 [INFO] 
======== alfworld_cap =======
2025-04-14 03:00:18,313 [INFO] {
    "build_info": {
        "annotations": {
            "train": {
                "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json",
                "url": "/srv/scratch/CRUISE/shuang/dataset/emac/train.json"
            },
            "val": null
        },
        "images": {
            "storage": "/srv/scratch/CRUISE/shuang/dataset/emac/images/alfworld_train"
        }
    },
    "data_type": "images",
    "text_processor": {
        "eval": {
            "max_words": 1024,
            "name": "blip_alfworld",
            "prompt": ""
        },
        "train": {
            "max_words": 1024,
            "name": "blip_alfworld",
            "prompt": ""
        }
    },
    "vis_processor": {
        "eval": {
            "image_size": 224,
            "name": "blip_image_eval"
        },
        "train": {
            "image_size": 224,
            "name": "blip_image_eval"
        }
    }
}
2025-04-14 03:00:18,313 [INFO] 
======  Model Attributes  ======
2025-04-14 03:00:18,313 [INFO] {
    "adaptor_tuning": false,
    "apply_lemmatizer": false,
    "arch": "blip2_emac",
    "avg_log_probs": true,
    "base_model": "https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth",
    "drop_path_rate": 0,
    "freeze_proj_layer": false,
    "freeze_qformer": true,
    "freeze_vit": true,
    "image_size": 224,
    "llm_model": "/srv/scratch/CRUISE/shuang/huggingface/hub/vicuna-7b-v1.1",
    "load_basemodel": true,
    "load_finetuned": false,
    "load_pretrained": false,
    "low_memory": true,
    "max_output_txt_len": 64,
    "max_txt_len": 1024,
    "mix_ratio": 0.5,
    "model_type": "vicuna13b",
    "num_query_token": 32,
    "pretrained": "https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/InstructBLIP/instruct_blip_vicuna7b_trimmed.pth",
    "qformer_text_input": false,
    "use_grad_checkpoint": true,
    "vit_precision": "fp16"
}
2025-04-14 03:00:18,329 [INFO] Using existing file /srv/scratch/CRUISE/shuang/dataset/emac/train.json.
Traceback (most recent call last):
  File "/srv/scratch/CRUISE/shuang/code/emac/train.py", line 96, in <module>
    main()
  File "/srv/scratch/CRUISE/shuang/code/emac/train.py", line 86, in main
    datasets = task.build_datasets(cfg)
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/tasks/base_task.py", line 57, in build_datasets
    dataset = builder.build_datasets()
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/datasets/builders/base_dataset_builder.py", line 51, in build_datasets
    self._download_data()
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/datasets/builders/base_dataset_builder.py", line 98, in _download_data
    self._download_ann()
  File "/srv/scratch/CRUISE/shuang/code/emac/lavis/datasets/builders/base_dataset_builder.py", line 121, in _download_ann
    urls, storage_paths = info.get("url", None), info.storage
AttributeError: 'NoneType' object has no attribute 'get'
[2025-04-14 03:00:22,260] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 56717) of binary: /srv/scratch/CRUISE/shuang/miniconda3/envs/emac/bin/python
Traceback (most recent call last):
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 810, in <module>
    main()
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 806, in main
    run(args)
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/srv/scratch/CRUISE/shuang/miniconda3/envs/emac/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-04-14_03:00:22
  host      : wp-zeta-c20.cse.unsw.edu.au
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 56717)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
